# Random documents generator
This apostrophe-cms module generates documents of about 2MB to populate
the database to run tests.

## Usage

1. Enable the module on app.js

```javascript
var apos = require('apostrophe')({
	shortName: 'test-project',
	modules: {
		//(...)
		'big-pieces': {},
		//(...)
	}
});
```
2. Populate the database

This will generate a database of about 2GB: 1024 documents of about 2MB.

Just run the task (will take a few minutes):

```
node app big-pieces:populate-db
```
* Note: every time you run this task, 1024 documents of 2MB are generated
and inserted. So, be careful.

3. Run the tests for the default autocomplete

```
node app big-pieces:test-default-autocomplete
```

If you want to save the results, redirect to a file: 

```
node app big-pieces:test-default-autocomplete > results-default.json
```

4. Run the tests for autocomplete using a separate collection

```
node app big-pieces:test-separate-collection
```

## My test results

Setup:
- SO: debian 9;
- Processor: Intel(R) Core(TM) i3-2377M CPU @ 1.50GHz;
- Memory: 6BG;
- Node: v10.15.3;
- Apostrophe: 2.102.2;
- MongoDB: docker official image - 4.0.10-xenial;
- Docker version: 18.09.5, build e8ff056dbc.

### Default autocomplete results
```javascript
r1 = {
times: [
				 7004.134073257446,
			 15342.931577682495,
			 3283.7405071258545,
			 2652.742332458496,
			 3549.4381980895996,
			 3234.8483238220215,
			 3316.9406871795654,
			 4063.1995029449463,
			 2509.4932022094727,
			 2719.9292736053467,
			 3048.5079765319824,
			 2320.5528659820557,
			 2282.1039485931396,
			 3123.1241874694824,
			 2985.2618408203125,
			 2490.2870559692383,
			 3680.148199081421,
			 3706.852470397949,
			 2987.9679107666016,
			 3211.963390350342,
			 2723.1290321350098,
			 3746.9114303588867,
			 3516.1379165649414,
			 3272.9865703582764,
			 2413.8363342285156,
			 2094.7542057037354,
			 2442.851499557495,
			 3446.6288146972656,
			 3458.5022773742676,
			 3695.6972732543945,
			 3182.187994003296,
			 3489.7105350494385,
			 3324.637285232544,
			 3256.1033096313477,
			 3100.653341293335,
			 3085.9321689605713,
			 3417.358564376831,
			 2409.4372024536133,
			 2896.5265140533447,
			 1987.7651901245117,
			 2866.7754039764404,
			 3046.3766803741455,
			 2898.2814407348633,
			 2767.012647628784,
			 2079.031425476074,
			 2671.372589111328,
			 3263.2299938201904,
			 2611.1776065826416,
			 1863.1975765228271
				 ],
				 totalTime: 162542.37034797668,
				 totalResults: 490,
				 averageTime: 3317.191231591361
};
```

### Separate collection results
```javascript
r2 = {
times: [
				 23.089811325073242,
			 74.30218696594238,
			 20.537248611450195,
			 28.63296890258789,
			 33.41210746765137,
			 21.671646118164062,
			 25.369518280029297,
			 28.307485580444336,
			 24.236576080322266,
			 24.02469253540039,
			 32.74310111999512,
			 33.25343894958496,
			 20.84833335876465,
			 23.5134334564209,
			 23.529333114624023,
			 29.399343490600586,
			 23.36402130126953,
			 27.67571449279785,
			 19.14349937438965,
			 25.378454208374023,
			 38.721622467041016,
			 37.334856033325195,
			 21.930261611938477,
			 22.450687408447266,
			 27.073501586914062,
			 26.580299377441406,
			 18.330291748046875,
			 35.16400718688965,
			 28.36005973815918,
			 14.551151275634766,
			 13.34109878540039,
			 22.6873779296875,
			 13.233186721801758,
			 13.222074508666992,
			 26.168777465820312,
			 25.85338592529297,
			 22.226648330688477,
			 19.64126205444336,
			 35.58998489379883,
			 34.92409133911133,
			 25.251310348510742,
			 27.58894157409668,
			 22.484914779663086,
			 34.98819541931152,
			 25.763446807861328,
			 27.73809242248535,
			 13.649499893188477,
			 23.122156143188477,
			 16.96240997314453
				 ],
				 totalTime: 1277.3665084838867,
				 totalResults: 490,
				 averageTime: 26.0687042547732
};
```


